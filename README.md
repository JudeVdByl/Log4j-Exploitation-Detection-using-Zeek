# Log4j Exploitation Detection using Zeek

## Objective
This project demonstrates how I detected a Log4j exploitation attempt by analyzing network traffic using the Zeek network monitoring tool. I investigated multiple log files such as `log4shell.pcapng`, `signature.log`, `http.log`, and `log4j.log`, identifying key indicators of exploitation.

## Skills Learned
- Packet capture analysis with Zeek.
- Identifying Log4j exploitation patterns in log files.
- Analyzing PCAP files for network-based threats.
- Extracting and decoding malicious payloads.

## Tools Used
- **Zeek**: Network security monitoring tool.
- **grep**: Command-line utility for searching plain-text data.
- **Nmap**: Network scanning tool used to detect vulnerabilities.
- **base64**: Utility for encoding/decoding base64 strings.
- **Linux Terminal**: For executing commands to analyze logs and PCAP files.

## Steps

### 1. Analyze `log4shell.pcapng` File
I started by analyzing the `log4shell.pcapng` file using the `detection-log4j.zeek` script to detect possible Log4j exploits.

```
zeek -C -r log4shell.pcapng detection-log4j.zeek
```

Next, I reviewed the `signature.log` file generated by Zeek to determine the number of signature hits related to the exploit.

```
cat signatures.log
```

Reference Image:  
![Analyzing pcap and signature.log](https://github.com/user-attachments/assets/6a3e94c1-54fb-41ed-8835-b130420c9f66)


### 2. Investigate `http.log` File
Using the `http.log` file, I identified which scanning tool was used. From the logs, I found that **Nmap** was involved in the scanning activity.

```
cat http.log
```

Reference Image:  
![Reviewing http.log](https://github.com/user-attachments/assets/42417280-18bf-4bdf-a640-ed8d35001678)


To further investigate, I used `grep` to filter out the extension of the exploit file being uploaded.

```
cat http.log | grep -E '\.[a-zA-Z]{5}'
```

Reference Image:  
![Grep to find exploit extension](https://github.com/user-attachments/assets/75594960-d23f-4633-81ad-1e4e2e96fcf7)


### 3. Decode Exploit Commands from `log4j.log`
I moved to the `log4j.log` file to analyze the base64 encoded malicious payload.

```
grep -o '[a-zA-Z0-9]\{2,\}=' log4j.log
```

The payload extracted was decoded using the base64 command, revealing critical exploitation details. After decoding, I identified the file created by the attack was named **pwned**.

```
echo 'dG91Y2ggL3RtcC9wd25lZAo=' | base64 --decode
```

Finally, I identified the command that created the file:

```
touch /tmp/pwned
```

Reference Image:  
![Analyzing log4j.log and decoding payload](https://github.com/user-attachments/assets/be53a0cb-21ae-4df7-a55c-7185927b9a03)


## Conclusion
By following these steps, I was able to detect and decode a Log4j exploitation attempt using Zeek, along with other command-line tools. This project enhanced my ability to investigate network-based exploits and malicious payloads within log and PCAP files.
